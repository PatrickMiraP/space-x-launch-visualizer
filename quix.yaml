# Quix Project Descriptor
# This file describes the data pipeline and configuration of resources of a Quix Project.

metadata:
  version: 1.0

# This section describes the Deployments of the data pipeline
deployments:
  - name: Launch Telemetry Producer
    application: launch-telemetry-producer
    version: latest
    deploymentType: Service
    resources:
      cpu: 200
      memory: 800
      replicas: 1
    variables:
      - name: output
        inputType: OutputTopic
        required: false
        value: launch-telemetry
  - name: Position XY calculation
    application: position-xy-calculation
    version: latest
    deploymentType: Service
    resources:
      cpu: 1000
      memory: 800
      replicas: 1
    variables:
      - name: input
        inputType: InputTopic
        required: false
        value: launch-telemetry-interpolated
      - name: output
        inputType: OutputTopic
        required: false
        value: launch-telemetry-xy
  - name: Rocket visualization
    application: rocket-visualization
    version: latest
    deploymentType: Service
    resources:
      cpu: 1000
      memory: 800
      replicas: 1
    publicAccess:
      enabled: true
      urlPrefix: rocketvisualization-6
    network:
      serviceName: visualization
      ports:
        - port: 80
          targetPort: 5000
    variables:
      - name: input
        inputType: InputTopic
        required: false
        value: launch-telemetry-xy
  - name: Interpolation
    application: interpolation
    version: latest
    deploymentType: Job
    resources:
      cpu: 1000
      memory: 800
      replicas: 1
    variables:
      - name: input
        inputType: InputTopic
        required: false
        value: launch-telemetry
      - name: output
        inputType: OutputTopic
        required: false
        value: launch-telemetry-interpolated
  - name: Position XY calculation 2
    application: position-xy-calculation
    version: latest
    deploymentType: Service
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    variables:
      - name: input
        inputType: InputTopic
        required: false
        value: launch-telemetry-interpolated
      - name: output
        inputType: OutputTopic
        required: false
        value: launch-telemetry-xy
      - name: test
        inputType: Secret
        description: 's'
        required: false
      - name: SENTRY_ENVIRONMENT
        inputType: FreeText
        description: Sentry environment for deployed Quix
        required: false
      - name: SENTRY_DSN
        inputType: FreeText
        description: Sentry DSN
        required: false
      - name: REPORT_NOTIFICATION_URL
        inputType: FreeText
        description: URL to notify activity/sleep/other reports to
        required: false
      - name: QUIX_COMMUNICATION_KEY
        inputType: Secret
        description: ''
        required: false
      - name: INFLUXDB_URL
        inputType: Secret
        description: InfluxDB URL
        required: false
        secretKey: INFLUXDB_URL
      - name: LOG_RSYSLOG_ADDR
        inputType: FreeText
        description: Host:Port for RSyslog server
        required: false
      - name: INPUT_TOPIC
        inputType: InputTopic
        description: ''
        required: false
        value: sleepdeviation_inputs
      - name: OUTPUT_TOPIC
        inputType: OutputTopic
        description: ''
        required: false
        value: startingreadiness_inputs
      - name: OUTPUT_TOPIC_2
        inputType: OutputTopic
        description: ''
        required: false
        value: ''
      - name: OUTPUT_TOPIC_3
        inputType: OutputTopic
        description: ''
        required: false
        value: '' 
# This section describes the Topics of the data pipeline
topics:
  - name: launch-telemetry
  - name: launch-telemetry-xy
  - name: launch-telemetry-interpolated
  - name: PolygonSource
  - name: aggregates-1s
